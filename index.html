<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ—©èµ·ããƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap');
        body { font-family: 'Zen Maru Gothic', sans-serif; }
        .tap-none { -webkit-tap-highlight-color: transparent; }
    </style>
</head>
<body class="bg-blue-50 min-h-screen pb-10">

    <header class="pt-6 pb-2 text-center">
        <h1 class="text-3xl font-bold text-orange-500 drop-shadow-sm">â˜€ï¸ æ—©èµ·ããƒãƒ£ãƒ³ãƒ”ã‚ªãƒ³</h1>
        <div id="dateContainer" class="text-lg font-bold text-gray-500 mt-1"></div>
    </header>

    <main class="max-w-md mx-auto px-4 space-y-6">

        <section class="grid grid-cols-5 gap-2" id="buttonArea">
            <button onclick="wakeUp('ã‚ã„')" id="btn-ã‚ã„" class="tap-none bg-white py-4 rounded-2xl shadow-md border-b-4 border-gray-200 active:border-b-0 active:translate-y-1 transition-all font-bold text-gray-700 disabled:bg-gray-200 disabled:border-none disabled:text-gray-400">ã‚ã„</button>
            <button onclick="wakeUp('ãã†ãŸ')" id="btn-ãã†ãŸ" class="tap-none bg-white py-4 rounded-2xl shadow-md border-b-4 border-gray-200 active:border-b-0 active:translate-y-1 transition-all font-bold text-gray-700 disabled:bg-gray-200 disabled:border-none disabled:text-gray-400">ãã†ãŸ</button>
            <button onclick="wakeUp('ã¯ã‚‹ã²')" id="btn-ã¯ã‚‹ã²" class="tap-none bg-white py-4 rounded-2xl shadow-md border-b-4 border-gray-200 active:border-b-0 active:translate-y-1 transition-all font-bold text-gray-700 disabled:bg-gray-200 disabled:border-none disabled:text-gray-400">ã¯ã‚‹ã²</button>
            <button onclick="wakeUp('ã‚ãã¨')" id="btn-ã‚ãã¨" class="tap-none bg-white py-4 rounded-2xl shadow-md border-b-4 border-gray-200 active:border-b-0 active:translate-y-1 transition-all font-bold text-gray-700 disabled:bg-gray-200 disabled:border-none disabled:text-gray-400">ã‚ãã¨</button>
            <button onclick="wakeUp('ãµã‚†ã‹')" id="btn-ãµã‚†ã‹" class="tap-none bg-white py-4 rounded-2xl shadow-md border-b-4 border-gray-200 active:border-b-0 active:translate-y-1 transition-all font-bold text-gray-700 disabled:bg-gray-200 disabled:border-none disabled:text-gray-400">ãµã‚†ã‹</button>
        </section>

        <div class="flex justify-center">
            <button onclick="undo()" id="undoBtn" class="tap-none flex items-center gap-1 bg-red-100 text-red-600 px-4 py-2 rounded-full text-sm font-bold shadow-sm active:scale-95 transition-transform disabled:opacity-30 disabled:pointer-events-none">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6" />
                </svg>
                ã¨ã‚Šã‘ã—
            </button>
        </div>

        <section class="bg-white rounded-3xl p-5 shadow-lg shadow-blue-100 border border-blue-100">
            <h3 class="text-gray-400 text-sm font-bold mb-4 flex items-center gap-2">
                <span class="bg-orange-400 w-1 h-4 rounded-full"></span> ğŸ† ä»Šæ—¥ã®ã˜ã‚…ã‚“ã„
            </h3>
            <div id="rankList" class="flex gap-2 min-h-[70px]">
                </div>
        </section>

        <section class="bg-white rounded-3xl p-5 shadow-lg shadow-blue-100 border border-blue-100">
            <h3 class="text-gray-400 text-sm font-bold mb-4 flex items-center gap-2">
                <span class="bg-blue-400 w-1 h-4 rounded-full"></span> ğŸ“… ã“ã‚“ã—ã‚…ã†ã®å¾—ç‚¹
            </h3>
            <div id="statsArea" class="flex justify-between gap-1">
                </div>
        </section>

        <footer class="flex justify-center gap-4 pt-4">
            <button onclick="nextDay()" class="text-xs text-gray-400 hover:text-gray-600 underline decoration-dotted">ãã‚‡ã†ãƒªã‚»ãƒƒãƒˆ</button>
            <button onclick="clearAll()" class="text-xs text-gray-400 hover:text-red-400 underline decoration-dotted">ã“ã‚“ã—ã‚…ã†ãƒªã‚»ãƒƒãƒˆ</button>
        </footer>

    </main>

    <script>
        const members = ['ã‚ã„', 'ãã†ãŸ', 'ã¯ã‚‹ã²', 'ã‚ãã¨', 'ãµã‚†ã‹'];
        let history = [];
        const pointsTable = [5, 4, 3, 2, 1];

        // æ—¥ä»˜è¡¨ç¤º
        const now = new Date();
        const days = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
        const dayOfWeek = now.getDay();
        const dateEl = document.getElementById('dateContainer');
        const colorClass = (dayOfWeek === 0) ? "text-red-500" : (dayOfWeek === 6) ? "text-blue-500" : "text-gray-500";
        dateEl.innerHTML = `${now.getMonth() + 1}æœˆ${now.getDate()}æ—¥ <span class="${colorClass}">(${days[dayOfWeek]})</span>`;

        // ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
        let weeklyScores = JSON.parse(localStorage.getItem('weeklyScores')) || {};
        members.forEach(m => { if(weeklyScores[m] === undefined) weeklyScores[m] = 0; });

        function wakeUp(name) {
            if (history.includes(name)) return;
            const rankIndex = history.length;
            const points = pointsTable[rankIndex];
            history.push(name);
            weeklyScores[name] += points;
            localStorage.setItem('weeklyScores', JSON.stringify(weeklyScores));
            updateUI();
        }

        function undo() {
            if (history.length === 0) return;
            const rankIndex = history.length - 1;
            const points = pointsTable[rankIndex];
            const removedName = history.pop();
            weeklyScores[removedName] = Math.max(0, weeklyScores[removedName] - points);
            localStorage.setItem('weeklyScores', JSON.stringify(weeklyScores));
            updateUI();
        }

        function updateUI() {
            // ä»Šæ—¥ã®é †ä½
            const rankList = document.getElementById('rankList');
            rankList.innerHTML = history.map((name, i) => `
                <div class="flex-1 bg-orange-50 border border-orange-100 rounded-2xl p-2 text-center animate-bounce-short">
                    <span class="block text-[10px] font-black text-orange-400 uppercase">${i+1}ä½</span>
                    <span class="block text-sm font-bold text-gray-700">${name}</span>
                    <span class="block text-[10px] text-orange-300">+${pointsTable[i]}pt</span>
                </div>
            `).join('');

            // ã“ã‚“ã—ã‚…ã†ã®å¾—ç‚¹
            const statsArea = document.getElementById('statsArea');
            statsArea.innerHTML = members.map(m => `
                <div class="flex-1 text-center p-2 rounded-xl bg-gray-50">
                    <span class="block text-[10px] text-gray-400 mb-1">${m}</span>
                    <span class="block text-xl font-black text-blue-500">${weeklyScores[m]}</span>
                </div>
            `).join('');

            // ãƒœã‚¿ãƒ³åˆ¶å¾¡
            members.forEach(m => {
                const btn = document.getElementById(`btn-${m}`);
                btn.disabled = history.includes(m);
                if(btn.disabled) btn.classList.add('opacity-50'); else btn.classList.remove('opacity-50');
            });
            document.getElementById('undoBtn').disabled = (history.length === 0);
        }

        function nextDay() { if(confirm("ä»Šæ—¥ã®é †ä½ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ")) location.reload(); }
        function clearAll() { if(confirm("ä»Šé€±ã®å¾—ç‚¹ã‚’ã™ã¹ã¦æ¶ˆå»ã—ã¾ã™ã‹ï¼Ÿ")) { localStorage.clear(); location.reload(); } }

        updateUI();
    </script>

    <style>
        @keyframes bounce-short {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-4px); }
        }
        .animate-bounce-short { animation: bounce-short 0.3s ease-out; }
    </style>
</body>
</html>
